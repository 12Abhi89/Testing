package solar_Battery_Charger;

import java.util.List;

import org.junit.rules.ExpectedException;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.paulhammant.ngwebdriver.ByAngular;
import com.paulhammant.ngwebdriver.NgWebDriver;

public class ConfigureTest {
	
	@BeforeMethod
	public void setup()
	{
		
	}
	
	
	@Test()
	public void configTest() throws InterruptedException {
		System.setProperty("webdriver.gecko.driver","C:\\Users\\ADMIN\\Tenxer\\AutoTesting\\Selenium_Jar_Files\\geckodriver.exe");
		WebDriver driver=new FirefoxDriver();
		JavascriptExecutor jsDriver=(JavascriptExecutor) driver;
		NgWebDriver ngDriver=new NgWebDriver(jsDriver);
		WebDriverWait wait = new WebDriverWait(driver,60);
		
		String pageurl = "https://renesas.evmlabs.com/#!/";
		driver.get(pageurl);
		ngDriver.waitForAngularRequestsToFinish();
		
		//Login Page
		driver.manage().window().maximize();
		driver.findElement(ByAngular.model("username")).sendKeys("abhishek@tenxertech.com");
		driver.findElement(ByAngular.model("password")).sendKeys("4KSVHCgxc6p7dV2");
		driver.findElement(ByAngular.buttonText("Login")).click();
		//Thread.sleep(10000);
		
		//EVM Selecting page
		wait.until(ExpectedConditions.elementToBeClickable(ByAngular.repeater("form in Forms")));
		driver.findElement(ByAngular.repeater("form in Forms")).findElement(By.className("material-icons")).click();
		
		
		//wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(0));
		//ISL81601-US011REFZ- Solar Battery Charger Page
		wait.until(ExpectedConditions.elementSelectionStateToBe(By.name("//iframe/html/body/div/div/div/nav/div/button[@class='min-max-toggle btn btn--icon' and @aria-label='minimize chat window toggle']"),"True"));
		//Thread.sleep(13000);
		//wait.until(ExpectedConditions.elementToBeClickable(By.xpath(".//iframe/html/body/div/div/div/nav/div/button[@class='min-max-toggle btn btn--icon' and @aria-label='minimize chat window toggle']")));
		driver.switchTo().frame(0);
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath("//html/body/div/div/div/nav/div/button/div/i")));
		driver.findElement(By.xpath("//html/body/div/div/div/nav/div/button[@class='min-max-toggle btn btn--icon' and @aria-label='minimize chat window toggle']")).click();
		driver.switchTo().parentFrame();
		driver.findElement(By.xpath("//button[@class='wmClose notop']")).click();
		
		
		List<WebElement> dropdown=driver.findElements(ByAngular.model("tnxmodel"));
		
		//Voc
		dropdown.get(0).click();
		Thread.sleep(1000);
		Select Voc=new Select(dropdown.get(0));
		Voc.selectByVisibleText("21 V");
		
		//Isc
		dropdown.get(1).click();
		Thread.sleep(1000);
		Select Isc=new Select(dropdown.get(1));
		Isc.selectByVisibleText("3 A");
		
		//Irradiance
		dropdown.get(2).click();
		Thread.sleep(1000);
		Select Irradiance=new Select(dropdown.get(2));
		Irradiance.selectByVisibleText("75 %");
		
		//Temp
		dropdown.get(3).click();
		Thread.sleep(1000);
		Select Temp=new Select(dropdown.get(3));
		Temp.selectByVisibleText("322");
		
		
		
		driver.findElement(By.xpath(".//button[@ng-class=\"getComToArr(data.class)\" and @ng-click=\"submitAll($event,data.allattrib)\" and @class=\"btn btn-primary btn-element  fat-btn\"]")).click();
		
		/*
		//Voc
		driver.findElement(ByAngular.model("tnxmodel")).click();
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(".//option[@ng-repeat=\"num in data | numtoarr track by $index\" and @value=30]")));
		driver.findElement(By.xpath(".//option[@ng-repeat=\"num in data | numtoarr track by $index\" and @value=30]")).click();
	    */
		
		//Thread.sleep(45000);
		//wait.until(ExpectedConditions.elementToBeSelected(By.xpath("//div[@ng-if=\"options\" and @class=\"ng-scope\"]")));
		
		//Boolean a=jsDriver.executeScript("return document.readyState").equals("complete");
		//wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//div[@ng-if=\"options\" and @class=\"ng-scope\"]")));
	
		WebElement i=driver.findElement(By.xpath("//div[@ng-if=\"options\" and @class=\"ng-scope\"]"));
		if(!i.getText().isEmpty())
		{
			System.out.println("Graph Exist");
		}
		else
		{
			System.out.println("Graph Doesn't Exist");
		}
		
	}

}
